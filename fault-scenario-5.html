<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Fault Scenario 5: Potash Mine Oil Level Monitoring</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">    <script src="worksheet-core.js"></script>
<script src="worksheet-tracking.js"></script>

</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp0539-worksheets.html'" class="nav-link">
            <i class="fas fa-cogs"></i> CP0539
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp6773-worksheets.html'" class="nav-link active">
            <i class="fas fa-exclamation-triangle"></i> CP6773
          </a>
        </li>
        
        <li class="nav-item">
          <a href="#" onclick="window.location='tracking-dashboard.html'" class="nav-link">
            <i class="fas fa-chart-line"></i> PROGRESS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='fault-scenario-4.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Scenario</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Fault Scenario 5 - Potash Mine Oil Level Monitoring</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='fault-scenario-6.html'">
            <span>Next Scenario</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> Fault Scenario 5: Potash Mine Oil Level Monitoring</h2>
      <div class="worksheet-content">
        <div class="scenario-info">
          <div class="info-grid">
            <div class="info-item">
              <strong>Company:</strong> Potash Mine in Yorkshire
            </div>
            <div class="info-item">
              <strong>Process:</strong> Oil level monitoring for mining shafts
            </div>
            <div class="info-item">
              <strong>Shift:</strong> Emergency call-out
            </div>
            <div class="info-item">
              <strong>Urgency:</strong> High - System won't start, safety critical
            </div>
            <div class="info-item">
              <strong>Difficulty:</strong> Advanced
            </div>
            <div class="info-item">
              <strong>Time:</strong> 30-40 minutes
            </div>
          </div>
        </div>

        <div class="background-section">
          <div class="background-text">
            <div class="scenario-description">
              <h3>Background</h3>
              <p>Your company has installed a new oil level monitoring system into a Potash mine in Yorkshire. This system monitors the oil level of two mining shafts that carry workers and potash minerals up a shaft.</p>
              
              <p>This system was known for having many huge leaks, which would lead to miners being stuck down in the mine. Your company installed a system to monitor if the oil is too high or too low.</p>
              
              <p>They've asked you to come out and fix the system as it won't start. There's an alarm active on the system, the system LED is red, but the alarm screen shows nothing. You're told the oil level is normal.</p>
              
              <p><strong>Industry Context:</strong> In mining operations, oil level monitoring is critical for shaft safety. Oil leaks can cause catastrophic failures that trap workers underground. The monitoring system must be reliable and accurate to prevent such incidents.</p>
            </div>
          </div>
          
          <div class="background-image">
            <img src="assets/scenarios/brine-system.png" alt="Potash Mine Oil Level Monitoring">
            <figcaption>Potash Mine Oil Level Monitoring - Mining Safety</figcaption>
          </div>
        </div>

        <div class="system-overview">
          <h3>System Status</h3>
          <div class="status-grid">
            <div class="status-item">
              <span class="status-label">System Operation:</span>
              <span class="status-value error">WON'T START</span>
            </div>
            <div class="status-item">
              <span class="status-label">System LED:</span>
              <span class="status-value error">RED</span>
            </div>
            <div class="status-item">
              <span class="status-label">Alarm Status:</span>
              <span class="status-value warning">ACTIVE</span>
            </div>
            <div class="status-item">
              <span class="status-label">Alarm Screen:</span>
              <span class="status-value">SHOWS NOTHING</span>
            </div>
            <div class="status-item">
              <span class="status-label">Oil Level:</span>
              <span class="status-value">NORMAL</span>
            </div>
            <div class="status-item">
              <span class="status-label">Shaft 1 Status:</span>
              <span class="status-value">UNKNOWN</span>
            </div>
            <div class="status-item">
              <span class="status-label">Shaft 2 Status:</span>
              <span class="status-value">UNKNOWN</span>
            </div>
            <div class="status-item">
              <span class="status-label">Safety Status:</span>
              <span class="status-value error">CRITICAL</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Troubleshooting Tips Section -->
    <div class="worksheet-section objectives-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> Troubleshooting Tips</h2>
      <div class="worksheet-content">
        <ul class="objectives-list">
          <li>Check alarm system communication and display functionality</li>
          <li>Verify sensor connections and signal integrity</li>
          <li>Inspect system power supply and electrical connections</li>
          <li>Test alarm screen and LED indicator functionality</li>
        </ul>
      </div>
    </div>

    <!-- Interactive Tools Section -->
    <div class="worksheet-section tools-section">
      <h2 class="section-header"><i class="fas fa-tools"></i> Investigation Tools</h2>
      <div class="worksheet-content">
        <div class="tools-grid">
          <div class="tool-card" onclick="useTool('check_alarm_system')">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Check Alarm System</h3>
            <p>Test alarm communication and display functionality</p>
          </div>
          <div class="tool-card" onclick="useTool('test_sensor_connections')">
            <i class="fas fa-microchip"></i>
            <h3>Test Sensor Connections</h3>
            <p>Verify sensor connections and signal integrity</p>
          </div>
          <div class="tool-card" onclick="useTool('inspect_power_supply')">
            <i class="fas fa-bolt"></i>
            <h3>Inspect Power Supply</h3>
            <p>Check system power and electrical connections</p>
          </div>
          <div class="tool-card" onclick="useTool('test_display_functionality')">
            <i class="fas fa-desktop"></i>
            <h3>Test Display Functionality</h3>
            <p>Check alarm screen and LED indicator operation</p>
          </div>
        </div>
        <div id="tool-results" class="tool-results"></div>
      </div>
    </div>

    <!-- Investigation Results Section -->
    <div class="worksheet-section results-section" id="investigation-results" style="display: none;">
      <h2 class="section-header"><i class="fas fa-clipboard-list"></i> Investigation Results</h2>
      <div class="results-content" id="results-content">
        <!-- Results will be populated by JavaScript -->
      </div>
    </div>

    <!-- Simulation Section - COMMENTED OUT
    <div class="worksheet-section simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> System Simulation</h2>
      <div class="worksheet-content">
        <div id="brine-flow-simulation" class="simulation-container">
          <div class="simulation-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading brine flow control simulation...</p>
          </div>
        </div>
        <div id="hmi-panel" class="simulation-container" style="margin-top: 20px;"></div>
        <div id="plc-io-panel" class="simulation-container" style="margin-top: 20px;"></div>
        <div id="fault-injection-panel" class="simulation-panel" style="margin-top: 20px;"></div>
        <div id="diagnostic-challenges-panel" class="simulation-panel" style="margin-top: 20px;"></div>
      </div>
    </div>
    -->

    <!-- Analysis Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-clipboard-list"></i> Fault Analysis Worksheet</h2>
      <div class="questions-content">
        <div class="analysis-section">
          <h4>Observations:</h4>
          <textarea class="answer-input" data-question="observations" placeholder="Record your observations of the system behavior, readings, and any unusual indicators..."></textarea>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer('observations')">Save Observations</button>
          </div>
        </div>
        
        <div class="analysis-section">
          <h4>Problem:</h4>
          <textarea class="answer-input" data-question="problem" placeholder="Identify the root cause and describe the specific problem affecting the system..."></textarea>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer('problem')">Save Problem Analysis</button>
          </div>
        </div>
        
        <div class="analysis-section">
          <h4>Solution:</h4>
          <textarea class="answer-input" data-question="solution" placeholder="Describe the steps you would take to resolve the issue safely and effectively..."></textarea>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer('solution')">Save Solution</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Simulation Scripts - COMMENTED OUT
  <script src="hmi-simulation.js"></script>
  <script src="plc-simulation.js"></script>
  <script src="valve-simulation.js"></script>
  <script src="pump-simulation.js"></script>
  -->
  <script>
    // Tool usage tracking
    let toolResults = {};
    
    function useTool(toolId) {
      const toolData = {
        'check_alarm_system': {
          title: 'Alarm System Analysis',
          content: 'Alarm system communication test reveals no signal from the oil level sensors. The alarm is active but no sensor data is being received. This explains why the alarm screen shows nothing despite an active alarm.',
          icon: 'fas fa-exclamation-triangle'
        },
        'test_sensor_connections': {
          title: 'Sensor Connection Test Results',
          content: 'Sensor connection test shows both oil level sensors are disconnected. Signal integrity test reveals open circuits on both sensor lines. The system cannot start because it has no sensor input to validate oil levels.',
          icon: 'fas fa-microchip'
        },
        'inspect_power_supply': {
          title: 'Power Supply Inspection',
          content: 'Power supply test shows normal voltage output (24V DC). However, the sensor power circuit shows intermittent connection. The sensor power is cycling on and off, preventing stable sensor operation.',
          icon: 'fas fa-bolt'
        },
        'test_display_functionality': {
          title: 'Display Functionality Test',
          content: 'Display functionality test shows the alarm screen and LED are working correctly. The red LED indicates an active alarm, but the screen shows nothing because there is no sensor data to display.',
          icon: 'fas fa-desktop'
        }
      };
      
      const result = toolData[toolId];
      if (result) {
        toolResults[toolId] = result;
        displayToolResult(toolId, result);
      }
    }
    
    function displayToolResult(toolId, result) {
      const resultsDiv = document.getElementById('tool-results');
      const resultHtml = `
        <div class="tool-result" id="result-${toolId}">
          <div class="result-header">
            <i class="${result.icon}"></i>
            <h3>${result.title}</h3>
          </div>
          <div class="result-content">
            <p>${result.content}</p>
          </div>
        </div>
      `;
      resultsDiv.innerHTML += resultHtml;
    }
    
    // Submit answer
    function submitAnswer(questionType) {
      const input = document.querySelector(`[data-question="${questionType}"]`);
      const answer = input.value.trim();
      
      if (answer) {
        // Save to local storage for backward compatibility
        localStorage.setItem(`fault5_${questionType}`, answer);
        
        // Track with the tracking system if available
        if (typeof trackFaultScenarioAnswer === 'function') {
          trackFaultScenarioAnswer(questionType, answer);
        }
        
        const button = event.target;
        const originalText = button.textContent;
        button.textContent = 'Saved!';
        button.style.background = '#4CAF50';
        
        setTimeout(() => {
          button.textContent = originalText;
        }, 2000);
      } else {
        alert('Please enter content before saving.');
      }
    }

    // Load saved answers
    function loadSavedAnswers() {
      const questionTypes = ['observations', 'problem', 'solution'];
      questionTypes.forEach(type => {
        const saved = localStorage.getItem(`fault5_${type}`);
        if (saved) {
          const input = document.querySelector(`[data-question="${type}"]`);
          if (input) {
            input.value = saved;
          }
        }
      });
    }
    
    // Load saved answers on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadSavedAnswers();
    });
  </script>
</body>
</html> 
