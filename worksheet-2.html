<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Emergency Stop System Maintenance</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>

</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp0539-worksheets.html'" class="nav-link">
            <i class="fas fa-cogs"></i> CP0539
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='cp6773-worksheets.html'" class="nav-link">
            <i class="fas fa-exclamation-triangle"></i> CP6773
          </a>
        </li>
        
        <li class="nav-item">
          <a href="#" onclick="window.location='tracking-dashboard.html'" class="nav-link">
            <i class="fas fa-chart-line"></i> PROGRESS
          </a>
        </li><li class="nav-item">
          <a href="#" onclick="window.location='settings.html'" class="nav-link">
            <i class="fas fa-gear"></i> SETTINGS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-1.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 2 - Emergency Stop System Maintenance</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-3.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>Emergency stop systems are critical safety devices designed to immediately shut down equipment in dangerous situations. These systems must be 100% reliable because lives depend on them functioning properly when needed.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/emergency-stops.png" alt="Emergency Stop System">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Run the system as you did in Worksheet 1.</strong></p>
        
        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Find the E-Stop</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Find the E-Stop on your training system.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Press the E-Stop</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Press the E-Stop to see how the system stops.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Reset the E-Stop</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Reset the E-Stop and check that the system starts again. This can be done by twisting the Estop anti-clockwise.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="4">
            <div class="step-number">4</div>
            <div class="step-content">
              <div class="step-header">
                <h4>System Reset</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Once the Estop has been released, the system must be reset by pressing the blue reset button to the left of the Estop or the reset button on the HMI.</p>
            </div>
          </div>
        </div>
      </div>
    </div>



    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <p>E-Stops have dual channels or two inputs into the control system, to make them reliable and safe:</p>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Two Contacts</strong>
            <p>The E-Stop button has two sets of contacts. Both must be closed for the system to function. When pressed, both contacts open and the system stops. Even if only one were to open, the system would still stop. This is done as a redundancy measure.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Reset Needed</strong>
            <p>After using an E-Stop, the emergency stop button must be reset and the reset button must be pressed once before the system can start again.</p>
          </div>
        </div>
        
        <p>Regularly inspect the E-Stop for damage or loose parts and test it during downtime to ensure it functions properly. Never cover or tamper with one.</p>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>E-Stops are for emergencies, not regular use.</strong>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>They have two safety circuits to make sure they work.</strong>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Regular checks and tests keep them reliable.</strong>
          </div>
        </div>
        
        <p>Knowing how to use an E-Stop can help keep everyone safe and the system running well.</p>
      </div>
    </div>

    <!-- Questions Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> 4. Questions & Answers</h2>
      <div class="questions-content">
        <div class="instructions">
          <strong>Instructions:</strong> Answer each question based on your observations and understanding of emergency stop systems.
        </div>
        
        <div class="question-item" data-question="1">
          <h4>Question 1: What is the main purpose of an Emergency Stop (E-Stop)?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) To quickly stop a machine or system in an emergency to protect people and equipment</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) To slow down the system gradually</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) To display warning messages</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) To restart the system automatically</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) To quickly stop a machine or system in an emergency to protect people and equipment.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: How do you reset the E-Stop after it has been pressed?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) Twist the E-Stop anti-clockwise, then press the blue reset button or the HMI reset button</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) Simply press the E-Stop button again</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) Turn off the main power switch</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) Wait for the system to reset automatically</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) Twist the E-Stop anti-clockwise, then press the blue reset button or the HMI reset button.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: What makes an E-Stop more reliable than a normal stop button?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) It has two contact channels; both must be closed for operation, and either opening will stop the system, this redundancy ensures safety</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) It is larger and more visible</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) It uses higher voltage</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) It is made of stronger materials</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) It has two contact channels; both must be closed for operation, and either opening will stop the system, this redundancy ensures safety.
          </div>
        </div>
        
        <div class="question-item" data-question="4">
          <h4>Question 4: When should an E-Stop be used?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) Only during emergencies, not for regular stopping of the machine</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) For normal shutdown procedures</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) To pause the system temporarily</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) To change system settings</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) Only during emergencies, not for regular stopping of the machine.
          </div>
        </div>
        
        <div class="question-item" data-question="5">
          <h4>Question 5: Why is it important to regularly inspect the E-Stop?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) To ensure it is free from damage or faults and will work properly when needed</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) To clean the button surface</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) To change the button color</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) To adjust the button position</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) To ensure it is free from damage or faults and will work properly when needed.
          </div>
        </div>
      </div>
    </div>

    <!-- Emergency Stop Simulation -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-hand-paper"></i> 5. Emergency Stop System Simulation</h2>
      
      <!-- EStop Channel Status Display -->
      <div class="simulation-container" style="margin-bottom: 25px;">
        <h4 style="color: #2196F3; margin-bottom: 20px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
          <i class="fas fa-microchip"></i> EStop Channel Status Monitor
        </h4>
        
        <div class="estop-io-display" style="background: #1a1a1a; border-radius: 12px; padding: 25px;">
          <div class="channel-status-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 20px;">
            <!-- Channel 1 -->
            <div class="channel-display">
              <h5 style="color: #4CAF50; margin-bottom: 15px; font-size: 16px;">
                <i class="fas fa-sign-in-alt"></i> Channel 1 (NC Contact)
              </h5>
              <div id="channel-1-status" class="channel-status" style="background: #333; padding: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                  <span style="color: #FFFFFF; font-size: 14px; font-weight: bold;">EStop Channel 1</span>
                  <div class="led-indicator" style="width: 16px; height: 16px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 10px #4CAF50;"></div>
                </div>
                <div style="color: #AAA; font-size: 12px;">Status: <span id="ch1-status-text" style="color: #4CAF50; font-weight: bold;">CLOSED</span></div>
                <div style="color: #AAA; font-size: 11px;">DI_0.0 - Primary Safety Circuit</div>
              </div>
            </div>
            
            <!-- Channel 2 -->
            <div class="channel-display">
              <h5 style="color: #4CAF50; margin-bottom: 15px; font-size: 16px;">
                <i class="fas fa-sign-in-alt"></i> Channel 2 (NC Contact)
              </h5>
              <div id="channel-2-status" class="channel-status" style="background: #333; padding: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                  <span style="color: #FFFFFF; font-size: 14px; font-weight: bold;">EStop Channel 2</span>
                  <div class="led-indicator" style="width: 16px; height: 16px; border-radius: 50%; background: #4CAF50; border: 2px solid #555; box-shadow: 0 0 10px #4CAF50;"></div>
                </div>
                <div style="color: #AAA; font-size: 12px;">Status: <span id="ch2-status-text" style="color: #4CAF50; font-weight: bold;">CLOSED</span></div>
                <div style="color: #AAA; font-size: 11px;">DI_0.1 - Secondary Safety Circuit</div>
              </div>
            </div>
          </div>
          
          <!-- System Status -->
          <div class="system-status-display" style="background: #2a2a2a; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
            <h5 style="color: #FFFFFF; margin-bottom: 15px;">System Safety Status</h5>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
              <div>
                <span style="color: #AAA; font-size: 12px;">Safety Circuit:</span>
                <div id="safety-circuit-status" style="color: #4CAF50; font-weight: bold; font-size: 14px;">SAFE - BOTH CHANNELS OK</div>
              </div>
              <div>
                <span style="color: #AAA; font-size: 12px;">Equipment Status:</span>
                <div id="equipment-status" style="color: #4CAF50; font-weight: bold; font-size: 14px;">RUNNING</div>
              </div>
              <div>
                <span style="color: #AAA; font-size: 12px;">Fault Status:</span>
                <div id="fault-status" style="color: #4CAF50; font-weight: bold; font-size: 14px;">NO FAULTS</div>
              </div>
            </div>
          </div>
          
          <!-- Control Buttons -->
          <div class="estop-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: center;">
            <div style="display: flex; justify-content: center;">
              <button id="estop-btn" class="estop-button" style="background: #F44336; color: white; border: none; width: 120px; height: 120px; border-radius: 50%; cursor: pointer; font-weight: bold; font-size: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                <i class="fas fa-hand-paper" style="font-size: 24px; margin-bottom: 8px;"></i>
                <div>EMERGENCY</div>
                <div>STOP</div>
              </button>
            </div>
            <button id="reset-estop-btn" class="reset-button" style="background: #2196F3; color: white; border: none; padding: 15px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px;" disabled>
              <i class="fas fa-undo"></i> RESET E-STOP
            </button>
            <button id="inject-fault-btn" class="fault-button" style="background: #FF9800; color: white; border: none; padding: 15px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px;">
              <i class="fas fa-exclamation-triangle"></i> INJECT WIRE BREAK
            </button>
            <button id="clear-fault-btn" class="clear-fault-button" style="background: #666; color: white; border: none; padding: 15px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px;" disabled>
              <i class="fas fa-wrench"></i> REPAIR WIRE
            </button>
          </div>
        </div>
      </div>
      
      <!-- Stop Condition Types -->
      <div class="simulation-container" style="margin-bottom: 25px;">
        <h4 style="color: #2196F3; margin-bottom: 20px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
          <i class="fas fa-chart-line"></i> Different EStop Response Types
        </h4>
        
        <!-- Type 1: Hard Stop -->
        <div class="stop-type-card" style="background: #1a1a1a; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px; align-items: start;">
            <div>
              <h5 style="color: #F44336; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; font-size: 18px;">
                <i class="fas fa-bolt"></i> Type 1: Hard Stop (Power Cut)
              </h5>
              <div style="background: #2a2a2a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <p style="color: #FFFFFF; margin-bottom: 10px; font-weight: bold;">Emergency Only Response</p>
                <p style="color: #AAA; font-size: 14px; line-height: 1.5; margin-bottom: 10px;">
                  Immediately cuts all power to the motor. Used only in true emergencies when immediate stopping is more important than equipment protection.
                </p>
                <p style="color: #F44336; font-size: 13px; font-weight: bold;">
                  ⚠️ Can cause mechanical stress and equipment damage
                </p>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button id="start-hard-stop" class="start-button" style="background: #4CAF50; color: white; border: none; padding: 12px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px;">
                  <i class="fas fa-play"></i> START MOTOR
                </button>
                <button id="demo-hard-stop" class="demo-button" style="background: #F44336; color: white; border: none; padding: 12px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px;" disabled>
                  <i class="fas fa-stop"></i> HARD STOP
                </button>
              </div>
            </div>
            <div>
              <div class="motor-graph" style="background: #333; padding: 15px; border-radius: 8px; height: 250px;">
                <canvas id="hard-stop-chart" style="width: 100%; height: 100%;"></canvas>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Type 2: Safe Torque Off -->
        <div class="stop-type-card" style="background: #1a1a1a; border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px; align-items: start;">
            <div>
              <h5 style="color: #FF9800; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; font-size: 18px;">
                <i class="fas fa-shield-alt"></i> Type 2: Safe Torque Off (STO)
              </h5>
              <div style="background: #2a2a2a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <p style="color: #FFFFFF; margin-bottom: 10px; font-weight: bold;">Safety Function</p>
                <p style="color: #AAA; font-size: 14px; line-height: 1.5; margin-bottom: 10px;">
                  Removes electrical torque from the motor drive while maintaining position feedback. Motor coasts to a stop using natural friction and load.
                </p>
                <p style="color: #FF9800; font-size: 13px; font-weight: bold;">
                  ✓ Prevents unexpected restart, reduces mechanical stress
                </p>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button id="start-sto" class="start-button" style="background: #4CAF50; color: white; border: none; padding: 12px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px;">
                  <i class="fas fa-play"></i> START MOTOR
                </button>
                <button id="demo-sto" class="demo-button" style="background: #FF9800; color: white; border: none; padding: 12px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px;" disabled>
                  <i class="fas fa-shield-alt"></i> STO STOP
                </button>
              </div>
            </div>
            <div>
              <div class="motor-graph" style="background: #333; padding: 15px; border-radius: 8px; height: 250px;">
                <canvas id="sto-chart" style="width: 100%; height: 100%;"></canvas>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Type 3: Controlled Stop -->
        <div class="stop-type-card" style="background: #1a1a1a; border-radius: 12px; padding: 25px;">
          <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px; align-items: start;">
            <div>
              <h5 style="color: #4CAF50; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; font-size: 18px;">
                <i class="fas fa-step-backward"></i> Type 3: Controlled Shutdown
              </h5>
              <div style="background: #2a2a2a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <p style="color: #FFFFFF; margin-bottom: 10px; font-weight: bold;">Planned Shutdown</p>
                <p style="color: #AAA; font-size: 14px; line-height: 1.5; margin-bottom: 10px;">
                  Gradually ramps down motor speed in a controlled manner. Allows time for safety sequences like retracting tools, closing valves, or completing cycles.
                </p>
                <p style="color: #4CAF50; font-size: 13px; font-weight: bold;">
                  ✓ Equipment protection, orderly shutdown, process safety
                </p>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button id="start-controlled" class="start-button" style="background: #4CAF50; color: white; border: none; padding: 12px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px;">
                  <i class="fas fa-play"></i> START MOTOR
                </button>
                <button id="demo-controlled-stop" class="demo-button" style="background: #4CAF50; color: white; border: none; padding: 12px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px;" disabled>
                  <i class="fas fa-step-backward"></i> CONTROLLED STOP
                </button>
              </div>
            </div>
            <div>
              <div class="motor-graph" style="background: #333; padding: 15px; border-radius: 8px; height: 250px;">
                <canvas id="controlled-chart" style="width: 100%; height: 100%;"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Reset Reminder -->
      <div class="simulation-container">
        <div style="background: linear-gradient(135deg, #1976D2, #1565C0); border-radius: 12px; padding: 25px; text-align: center;">
          <h4 style="color: white; margin-bottom: 15px; font-size: 20px;">
            <i class="fas fa-exclamation-circle"></i> Important Safety Reminder
          </h4>
          <p style="color: white; font-size: 16px; margin-bottom: 20px; font-weight: 500;">
            Remember to always hit the <strong>Fault Reset</strong> or <strong>Controls Reset</strong> button after clearing an emergency stop!
          </p>
          <div style="background: rgba(255,255,255,0.2); border-radius: 8px; padding: 15px; margin-bottom: 15px;">
            <p style="color: white; margin: 0; font-size: 14px;">
              The system requires explicit reset confirmation to ensure the operator has acknowledged the emergency condition and verified it's safe to resume operation.
            </p>
          </div>
          <button id="system-reset-btn" class="system-reset-button" style="background: #4CAF50; color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;" disabled>
            <i class="fas fa-power-off"></i> SYSTEM RESET
          </button>
        </div>
      </div>
    </div>
  </div>

    <!-- Scripts -->
  <script>
    let estopPressed = false;
    let wireBreakInjected = false;
    let systemState = 'normal'; // 'normal', 'estop', 'wire-break'
    
    document.addEventListener('DOMContentLoaded', function() {
      initializeEmergencyStopSimulation();
      initializeStepTracking();
      loadSavedAnswers();
      initializeChartJSGraphs();
    });
    
    function initializeEmergencyStopSimulation() {
      const estopBtn = document.getElementById('estop-btn');
      const resetEstopBtn = document.getElementById('reset-estop-btn');
      const injectFaultBtn = document.getElementById('inject-fault-btn');
      const clearFaultBtn = document.getElementById('clear-fault-btn');
      const systemResetBtn = document.getElementById('system-reset-btn');
      
      // Demo buttons
      const startHardStopBtn = document.getElementById('start-hard-stop');
      const demoHardStopBtn = document.getElementById('demo-hard-stop');
      const startStoBtn = document.getElementById('start-sto');
      const demoStoBtn = document.getElementById('demo-sto');
      const startControlledBtn = document.getElementById('start-controlled');
      const demoControlledStopBtn = document.getElementById('demo-controlled-stop');
      
      // E-stop button click
      estopBtn?.addEventListener('click', function() {
        activateEmergencyStop();
      });
      
      // Reset E-stop button click
      resetEstopBtn?.addEventListener('click', function() {
        resetEStop();
      });
      
      // Inject Fault button click
      injectFaultBtn?.addEventListener('click', function() {
        injectWireBreak();
      });
      
      // Clear Fault button click
      clearFaultBtn?.addEventListener('click', function() {
        clearWireBreak();
      });
      
      // System Reset button click
      systemResetBtn?.addEventListener('click', function() {
        resetSystem();
      });
      
      // Demo button clicks
      startHardStopBtn?.addEventListener('click', function() {
        startMotorDemo('hard-stop');
      });
      
      demoHardStopBtn?.addEventListener('click', function() {
        demonstrateHardStop();
      });
      
      startStoBtn?.addEventListener('click', function() {
        startMotorDemo('sto');
      });
      
      demoStoBtn?.addEventListener('click', function() {
        demonstrateSTO();
      });
      
      startControlledBtn?.addEventListener('click', function() {
        startMotorDemo('controlled');
      });
      
      demoControlledStopBtn?.addEventListener('click', function() {
        demonstrateControlledStop();
      });
    }
    
    function activateEmergencyStop() {
      estopPressed = true;
      systemState = 'estop';
      
      // Update channel status - EStop pressed means BOTH channels open
      updateChannelStatus('ch1-status-text', 'OPEN', '#F44336');
      updateChannelStatus('ch2-status-text', 'OPEN', '#F44336');
      updateChannelVisual('channel-1-status', '#F44336');
      updateChannelVisual('channel-2-status', '#F44336');
      
      // Update system status
      updateSystemStatus('UNSAFE - BOTH CHANNELS OPEN', '#F44336');
      updateEquipmentStatus('STOPPED', '#F44336');
      updateFaultStatus('EMERGENCY STOP ACTIVATED', '#F44336');
      
      // Update button states
      updateButtonText('estop-btn', 'EMERGENCY STOP ACTIVATED', '#C62828');
      updateButtonText('reset-estop-btn', 'RESET E-STOP', '#2196F3');
      document.getElementById('reset-estop-btn').disabled = false;
      document.getElementById('system-reset-btn').disabled = false;
      
      console.log('Emergency stop activated!');
    }
    
    function resetEStop() {
      if (!estopPressed) return;
      
      estopPressed = false;
      systemState = 'normal';
      
      // Update channel status - EStop released means both channels closed
      updateChannelStatus('ch1-status-text', 'CLOSED', '#4CAF50');
      updateChannelStatus('ch2-status-text', 'CLOSED', '#4CAF50');
      updateChannelVisual('channel-1-status', '#4CAF50');
      updateChannelVisual('channel-2-status', '#4CAF50');
      
      // Update system status
      updateSystemStatus('SAFE - BOTH CHANNELS OK', '#4CAF50');
      updateEquipmentStatus('READY TO START', '#4CAF50');
      updateFaultStatus('NO FAULTS', '#4CAF50');
      
      // Update button states
      updateButtonText('estop-btn', 'PRESS E-STOP', '#F44336');
      document.getElementById('reset-estop-btn').disabled = true;
      
      console.log('E-stop reset completed');
    }
    
    function injectWireBreak() {
      wireBreakInjected = true;
      systemState = 'wire-break';
      
      // Simulate wire break - Channel 1 opens, Channel 2 stays closed
      updateChannelStatus('ch1-status-text', 'OPEN', '#F44336');
      updateChannelStatus('ch2-status-text', 'CLOSED', '#4CAF50');
      updateChannelVisual('channel-1-status', '#F44336');
      updateChannelVisual('channel-2-status', '#4CAF50');
      
      // Update system status
      updateSystemStatus('UNSAFE - CHANNEL 1 WIRE BREAK', '#F44336');
      updateEquipmentStatus('STOPPED', '#F44336');
      updateFaultStatus('FAULT - WIRE BREAK DETECTED', '#F44336');
      
      // Update button states
      updateButtonText('inject-fault-btn', 'FAULT INJECTED', '#FF9800');
      document.getElementById('inject-fault-btn').disabled = true;
      document.getElementById('clear-fault-btn').disabled = false;
      document.getElementById('reset-estop-btn').disabled = true;
      
      console.log('Wire break fault injected!');
    }
    
    function clearWireBreak() {
      if (!wireBreakInjected) return;
      
      wireBreakInjected = false;
      systemState = 'normal';
      
      // Repair wire break - both channels closed again
      updateChannelStatus('ch1-status-text', 'CLOSED', '#4CAF50');
      updateChannelStatus('ch2-status-text', 'CLOSED', '#4CAF50');
      updateChannelVisual('channel-1-status', '#4CAF50');
      updateChannelVisual('channel-2-status', '#4CAF50');
      
      // Update system status
      updateSystemStatus('SAFE - BOTH CHANNELS OK', '#4CAF50');
      updateEquipmentStatus('RUNNING', '#4CAF50');
      updateFaultStatus('NO FAULTS', '#4CAF50');
      
      // Update button states
      updateButtonText('inject-fault-btn', 'INJECT WIRE BREAK', '#FF9800');
      updateButtonText('clear-fault-btn', 'REPAIR WIRE', '#666');
      document.getElementById('inject-fault-btn').disabled = false;
      document.getElementById('clear-fault-btn').disabled = true;
      
      console.log('Wire break repaired!');
    }
    
    function resetSystem() {
      estopPressed = false;
      wireBreakInjected = false;
      systemState = 'normal';
      
      // Reset all channels to normal
      updateChannelStatus('ch1-status-text', 'CLOSED', '#4CAF50');
      updateChannelStatus('ch2-status-text', 'CLOSED', '#4CAF50');
      updateChannelVisual('channel-1-status', '#4CAF50');
      updateChannelVisual('channel-2-status', '#4CAF50');
      
      // Reset system status
      updateSystemStatus('SAFE - BOTH CHANNELS OK', '#4CAF50');
      updateEquipmentStatus('RUNNING', '#4CAF50');
      updateFaultStatus('NO FAULTS', '#4CAF50');
      
      // Reset all buttons
      updateButtonText('estop-btn', 'PRESS E-STOP', '#F44336');
      updateButtonText('inject-fault-btn', 'INJECT WIRE BREAK', '#FF9800');
      updateButtonText('clear-fault-btn', 'REPAIR WIRE', '#666');
      
      document.getElementById('reset-estop-btn').disabled = true;
      document.getElementById('clear-fault-btn').disabled = true;
      document.getElementById('system-reset-btn').disabled = true;
      document.getElementById('inject-fault-btn').disabled = false;
      
      console.log('System reset completed');
    }
    
    // Helper functions
    function updateChannelStatus(elementId, text, color) {
      const element = document.getElementById(elementId);
      if (element) {
        element.textContent = text;
        element.style.color = color;
      }
    }
    
    function updateChannelVisual(elementId, color) {
      const element = document.getElementById(elementId);
      if (element) {
        element.style.borderLeft = `4px solid ${color}`;
        
        // Update LED indicator
        const led = element.querySelector('.led-indicator');
        if (led) {
          led.style.background = color;
          led.style.boxShadow = `0 0 10px ${color}`;
        }
      }
    }
    
    function updateSystemStatus(text, color) {
      const element = document.getElementById('safety-circuit-status');
      if (element) {
        element.textContent = text;
        element.style.color = color;
      }
    }
    
    function updateEquipmentStatus(text, color) {
      const element = document.getElementById('equipment-status');
      if (element) {
        element.textContent = text;
        element.style.color = color;
      }
    }
    
    function updateFaultStatus(text, color) {
      const element = document.getElementById('fault-status');
      if (element) {
        element.textContent = text;
        element.style.color = color;
      }
    }
    
    function updateButtonText(elementId, text, color) {
      const element = document.getElementById(elementId);
      if (element) {
        if (elementId === 'estop-btn') {
          // Special handling for circular estop button
          if (text.includes('ACTIVATED')) {
            element.innerHTML = `
              <i class="fas fa-hand-paper" style="font-size: 24px; margin-bottom: 8px;"></i>
              <div>EMERGENCY</div>
              <div>ACTIVATED</div>
            `;
          } else {
            element.innerHTML = `
              <i class="fas fa-hand-paper" style="font-size: 24px; margin-bottom: 8px;"></i>
              <div>EMERGENCY</div>
              <div>STOP</div>
            `;
          }
          element.style.background = color;
        } else {
          const icon = element.innerHTML.includes('fas') ? element.innerHTML.split('>')[0] + '>' : '<i class="fas fa-hand-paper"></i>';
          element.innerHTML = `${icon} ${text}`;
          element.style.background = color;
        }
      }
    }
    
    // Chart.js motor graph functions
    let charts = {};
    let animationIntervals = {};
    let motorStates = {}; // Track motor state for each chart
    let timeCounters = {}; // Track time for each chart
    
    function initializeChartJSGraphs() {
      initializeChart('hard-stop-chart', 'Hard Stop Motor Response', '#F44336');
      initializeChart('sto-chart', 'Safe Torque Off Motor Response', '#FF9800');
      initializeChart('controlled-chart', 'Controlled Stop Motor Response', '#4CAF50');
    }
    
    function initializeChart(canvasId, title, color) {
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      // Initialize motor state
      motorStates[canvasId] = 'stopped'; // 'stopped', 'starting', 'running', 'stopping'
      timeCounters[canvasId] = 0;
      
      charts[canvasId] = new Chart(ctx, {
        type: 'line',
        data: {
          labels: Array.from({length: 30}, (_, i) => i), // Rolling 30-second window
          datasets: [{
            label: 'Motor RPM',
            data: Array(30).fill(0),
            borderColor: color,
            backgroundColor: color + '20',
            borderWidth: 3,
            fill: false,
            tension: 0.1,
            pointRadius: 0,
            pointHoverRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: title,
              color: '#FFFFFF',
              font: {
                size: 14,
                weight: 'bold'
              }
            },
            legend: {
              labels: {
                color: '#FFFFFF'
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Time (seconds)',
                color: '#FFFFFF'
              },
              ticks: {
                color: '#FFFFFF',
                maxTicksLimit: 10
              },
              grid: {
                color: '#555'
              }
            },
            y: {
              title: {
                display: true,
                text: 'Motor RPM',
                color: '#FFFFFF'
              },
              min: 0,
              max: 1500,
              ticks: {
                color: '#FFFFFF'
              },
              grid: {
                color: '#555'
              }
            }
          },
          animation: {
            duration: 0
          }
        }
      });
    }
    
    function startMotorDemo(type) {
      const chartId = type + '-chart';
      const chart = charts[chartId];
      if (!chart) return;
      
      // Clear any existing animation
      if (animationIntervals[type]) {
        clearInterval(animationIntervals[type]);
      }
      
      // Reset chart data and state
      chart.data.datasets[0].data = Array(30).fill(0);
      chart.data.labels = Array.from({length: 30}, (_, i) => i);
      motorStates[chartId] = 'starting';
      timeCounters[chartId] = 0;
      chart.update('none');
      
      // Enable/disable buttons
      const startBtn = document.getElementById('start-' + type);
      let stopBtnId;
      if (type === 'hard-stop') {
        stopBtnId = 'demo-hard-stop';
      } else if (type === 'sto') {
        stopBtnId = 'demo-sto';
      } else if (type === 'controlled') {
        stopBtnId = 'demo-controlled-stop';
      }
      const stopBtn = document.getElementById(stopBtnId);
      
      if (startBtn) {
        startBtn.disabled = true;
        startBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> STARTING...';
      }
      
      if (stopBtn) {
        stopBtn.disabled = true;
      }
      
      // Start continuous animation
      let startupTime = 0;
      animationIntervals[type] = setInterval(() => {
        const currentTime = timeCounters[chartId];
        let rpm = 0;
        
        if (motorStates[chartId] === 'starting') {
          // Motor startup phase (3 seconds)
          if (startupTime < 15) { // 15 * 200ms = 3 seconds
            const progress = startupTime / 15;
            const smoothProgress = 3 * progress * progress - 2 * progress * progress * progress; // S-curve
            rpm = Math.round(1400 * smoothProgress);
            startupTime++;
          } else {
            // Motor reaches full speed
            motorStates[chartId] = 'running';
            rpm = 1400;
            
            // Enable stop button and reset start button
            if (startBtn) {
              startBtn.disabled = false;
              startBtn.innerHTML = '<i class="fas fa-play"></i> START MOTOR';
            }
            if (stopBtn) {
              stopBtn.disabled = false;
            }
          }
        } else if (motorStates[chartId] === 'running') {
          // Motor running at full speed
          rpm = 1400;
        } else if (motorStates[chartId] === 'stopping') {
          // Stop animation is handled in the individual stop functions
          return;
        }
        
        // Shift data for rolling window effect
        chart.data.datasets[0].data.shift();
        chart.data.datasets[0].data.push(rpm);
        
        // Update time labels for rolling window
        chart.data.labels.shift();
        chart.data.labels.push(currentTime);
        
        timeCounters[chartId]++;
        chart.update('none');
        
      }, 200); // Update every 200ms for smooth animation
    }
    

    
    function demonstrateHardStop() {
      const chartId = 'hard-stop-chart';
      const chart = charts[chartId];
      if (!chart || motorStates[chartId] !== 'running') return;
      
      // Change motor state to stopping
      motorStates[chartId] = 'stopping';
      
      // Clear the existing animation
      if (animationIntervals['hard-stop']) {
        clearInterval(animationIntervals['hard-stop']);
      }
      
      // Immediate hard stop - create new animation that shows instant drop
      let stopAnimationStep = 0;
      animationIntervals['hard-stop'] = setInterval(() => {
        const currentTime = timeCounters[chartId];
        let rpm = 0; // Immediate stop to 0 RPM
        
        // Shift data for rolling window effect
        chart.data.datasets[0].data.shift();
        chart.data.datasets[0].data.push(rpm);
        
        // Update time labels for rolling window
        chart.data.labels.shift();
        chart.data.labels.push(currentTime);
        
        timeCounters[chartId]++;
        chart.update('none');
        
        // Continue showing 0 RPM for a few seconds then stop animation
        stopAnimationStep++;
        if (stopAnimationStep > 25) { // 5 seconds of showing stopped state
          clearInterval(animationIntervals['hard-stop']);
          motorStates[chartId] = 'stopped';
        }
      }, 200);
      
      // Update button
      const stopBtn = document.getElementById('demo-hard-stop');
      if (stopBtn) {
        stopBtn.disabled = true;
        stopBtn.innerHTML = '<i class="fas fa-stop"></i> STOPPED';
        setTimeout(() => {
          stopBtn.innerHTML = '<i class="fas fa-stop"></i> HARD STOP';
        }, 2000);
      }
    }
    
    function demonstrateSTO() {
      const chartId = 'sto-chart';
      const chart = charts[chartId];
      if (!chart || motorStates[chartId] !== 'running') return;
      
      // Change motor state to stopping
      motorStates[chartId] = 'stopping';
      
      // Clear the existing animation
      if (animationIntervals['sto']) {
        clearInterval(animationIntervals['sto']);
      }
      
      // STO - exponential coast down
      let stopAnimationStep = 0;
      const initialRPM = 1400;
      
      animationIntervals['sto'] = setInterval(() => {
        const currentTime = timeCounters[chartId];
        
        // Exponential decay for coasting down
        const decayFactor = Math.exp(-stopAnimationStep / 20); // Slower decay for coasting
        let rpm = Math.round(initialRPM * decayFactor);
        
        // Ensure we eventually reach 0
        if (rpm < 10) rpm = 0;
        
        // Shift data for rolling window effect
        chart.data.datasets[0].data.shift();
        chart.data.datasets[0].data.push(rpm);
        
        // Update time labels for rolling window
        chart.data.labels.shift();
        chart.data.labels.push(currentTime);
        
        timeCounters[chartId]++;
        chart.update('none');
        
        stopAnimationStep++;
        
        // Stop animation when motor has coasted to a stop
        if (rpm === 0 && stopAnimationStep > 40) { // About 8 seconds of coasting
          clearInterval(animationIntervals['sto']);
          motorStates[chartId] = 'stopped';
        }
      }, 200);
      
      // Update button
      const stopBtn = document.getElementById('demo-sto');
      if (stopBtn) {
        stopBtn.disabled = true;
        stopBtn.innerHTML = '<i class="fas fa-shield-alt"></i> COASTING...';
        setTimeout(() => {
          stopBtn.innerHTML = '<i class="fas fa-shield-alt"></i> STO STOP';
        }, 2000);
      }
    }
    
    function demonstrateControlledStop() {
      const chartId = 'controlled-chart';
      const chart = charts[chartId];
      if (!chart || motorStates[chartId] !== 'running') return;
      
      // Change motor state to stopping
      motorStates[chartId] = 'stopping';
      
      // Clear the existing animation
      if (animationIntervals['controlled']) {
        clearInterval(animationIntervals['controlled']);
      }
      
      // Controlled stop - linear ramp down
      let stopAnimationStep = 0;
      const initialRPM = 1400;
      const rampDuration = 50; // 10 seconds for controlled ramp down
      
      animationIntervals['controlled'] = setInterval(() => {
        const currentTime = timeCounters[chartId];
        
        // Linear ramp down
        const progress = Math.min(stopAnimationStep / rampDuration, 1);
        let rpm = Math.round(initialRPM * (1 - progress));
        
        // Ensure we reach 0
        if (progress >= 1) rpm = 0;
        
        // Shift data for rolling window effect
        chart.data.datasets[0].data.shift();
        chart.data.datasets[0].data.push(rpm);
        
        // Update time labels for rolling window
        chart.data.labels.shift();
        chart.data.labels.push(currentTime);
        
        timeCounters[chartId]++;
        chart.update('none');
        
        stopAnimationStep++;
        
        // Stop animation when ramp down is complete
        if (stopAnimationStep > rampDuration + 10) { // Extra time to show stopped state
          clearInterval(animationIntervals['controlled']);
          motorStates[chartId] = 'stopped';
        }
      }, 200);
      
      // Update button
      const stopBtn = document.getElementById('demo-controlled-stop');
      if (stopBtn) {
        stopBtn.disabled = true;
        stopBtn.innerHTML = '<i class="fas fa-step-backward"></i> RAMPING DOWN...';
        setTimeout(() => {
          stopBtn.innerHTML = '<i class="fas fa-step-backward"></i> CONTROLLED STOP';
        }, 2000);
      }
    }
    
    function initializeStepTracking() {
      const checkboxes = document.querySelectorAll('.step-complete-checkbox');
      checkboxes.forEach((checkbox, index) => {
        checkbox.addEventListener('change', function() {
          localStorage.setItem(`worksheet2_step${index + 1}`, this.checked);
        });
        
        const saved = localStorage.getItem(`worksheet2_step${index + 1}`);
        if (saved === 'true') {
          checkbox.checked = true;
        }
      });
    }
    
    function submitAnswer(questionNumber) {
      const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
      if (!answerInput) return;
      
      const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
      if (!selectedOption) {
        alert('Please select an answer before submitting.');
        return;
      }
      
      const answer = selectedOption.value;
      
      // Save with enhanced tracking
      worksheetTracker.saveAnswer(2, questionNumber, answer, 'maintenance');
      
      // Define correct answers for worksheet 2
      const correctAnswers = {
            "1": "A",
            "2": "A",
            "3": "A",
            "4": "A",
            "5": "A"
      };
      
      // Apply visual feedback
      const allOptions = answerInput.querySelectorAll('.option-label');
      const correctAnswer = correctAnswers[questionNumber];
      
      allOptions.forEach(option => {
        const radio = option.querySelector('.option-radio');
        const optionValue = radio.value;
        
        if (optionValue === correctAnswer) {
          option.classList.add('correct');
        } else if (optionValue === answer && answer !== correctAnswer) {
          option.classList.add('incorrect');
        }
      });
      
      // Mark question as submitted to disable further interaction
      answerInput.classList.add('submitted');
      
      // Show feedback on button
      const submitBtn = answerInput.querySelector('.submit-question-btn');
      if (submitBtn) {
        const originalText = submitBtn.textContent;
        submitBtn.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
        submitBtn.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
        
        // Add incorrect class for enhanced styling
        if (answer !== correctAnswer) {
          submitBtn.classList.add('incorrect');
        }
        
        setTimeout(() => {
          submitBtn.textContent = originalText;
          submitBtn.style.background = '#4CAF50';
          submitBtn.classList.remove('incorrect');
        }, 2000);
      }
      
      // Show correct answer if available
      const correctAnswerDiv = answerInput.querySelector('.correct-answer');
      if (correctAnswerDiv) {
        correctAnswerDiv.style.display = 'block';
      }
    }
    function loadSavedAnswers() {
      // This function is now handled by the tracking system
    }
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-1.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
      <div class="worksheet-header-center">
        <h1 class="worksheet-title">Worksheet 2 - Emergency Stop System Maintenance</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-3.html'">
          <span>Next Worksheet</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
  
</body>
</html> 